<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Mohamed Muhannad"><meta name=description content="Muhannad's personal website"><meta name=keywords content="blog,sysadmin,engineer,cloud,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Deploy a Hugo website using Github Actions on Github Pages"><meta name=twitter:description content="Introduction In this guide, I&rsquo;m going to explain how I&rsquo;m deploying this website to Github Pages with couple of git commit (and followed by git push of course).
Links will be provided to the other guides I used for reference as we go along the process.
The choice for Hugo as a static site generator is mainly because:
 It is very quick to build. The ability to use markdown syntax to create your pages is nice."><meta property="og:title" content="Deploy a Hugo website using Github Actions on Github Pages"><meta property="og:description" content="Introduction In this guide, I&rsquo;m going to explain how I&rsquo;m deploying this website to Github Pages with couple of git commit (and followed by git push of course).
Links will be provided to the other guides I used for reference as we go along the process.
The choice for Hugo as a static site generator is mainly because:
 It is very quick to build. The ability to use markdown syntax to create your pages is nice."><meta property="og:type" content="article"><meta property="og:url" content="https://muhannad0.github.io/posts/deploy-hugo-with-github-actions-on-github-pages/"><meta property="article:published_time" content="2020-04-20T15:42:13+05:00"><meta property="article:modified_time" content="2020-04-20T15:42:13+05:00"><base href=https://muhannad0.github.io/posts/deploy-hugo-with-github-actions-on-github-pages/><title>Deploy a Hugo website using Github Actions on Github Pages · Ops Monde</title><link rel=canonical href=https://muhannad0.github.io/posts/deploy-hugo-with-github-actions-on-github-pages/><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.13.0/css/all.css integrity=sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=https://muhannad0.github.io/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin=anonymous media=screen><link rel=stylesheet href=https://muhannad0.github.io/css/coder-dark.min.83a2010dac9f59f943b3004cd6c4f230507ad036da635d3621401d42ec4e2835.css integrity="sha256-g6IBDayfWflDswBM1sTyMFB60DbaY102IUAdQuxOKDU=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=https://muhannad0.github.io/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://muhannad0.github.io/images/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.69.0"></head><body class=colorscheme-auto><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://muhannad0.github.io/>Ops Monde</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fas fa-bars"></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://muhannad0.github.io/posts/>Blog</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Deploy a Hugo website using Github Actions on Github Pages</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fas fa-calendar"></i><time datetime=2020-04-20T15:42:13+05:00>April 20, 2020</time></span>
<span class=reading-time><i class="fas fa-clock"></i>4-minute read</span></div><div class=tags><i class="fas fa-tag"></i><a href=https://muhannad0.github.io/tags/guide/>guide</a>
<span class=separator>•</span>
<a href=https://muhannad0.github.io/tags/hugo/>hugo</a>
<span class=separator>•</span>
<a href=https://muhannad0.github.io/tags/github/>github</a>
<span class=separator>•</span>
<a href=https://muhannad0.github.io/tags/automation/>automation</a></div></div></header><div><h2 id=introduction>Introduction</h2><p>In this guide, I&rsquo;m going to explain how I&rsquo;m deploying this website to Github Pages with couple of <code>git commit</code> (and followed by <code>git push</code> of course).</p><p>Links will be provided to the other guides I used for reference as we go along the process.</p><p>The choice for <a href=https://gohugo.io/>Hugo</a> as a static site generator is mainly because:</p><ul><li>It is very quick to build.</li><li>The ability to use markdown syntax to create your pages is nice.</li><li>There&rsquo;s a nice selection of themes to use on your website.</li></ul><p>I&rsquo;ll show how I used the new <a href=https://help.github.com/en/actions>Github Actions</a> feature to automate publishing it to <a href=https://help.github.com/en/github/working-with-github-pages>Github Pages</a>. Special thanks to the contributions made to <a href="https://github.com/marketplace?category=deployment&type=actions">Github Marketplace</a>, where you can avoid re-inventing the wheel and make quick progress with your CI/CD pipelines.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Basic usage of Git. DigitalOcean has a great <a href=https://www.digitalocean.com/community/tutorial_series/introduction-to-git-installation-usage-and-branches>starter guide</a> you can start learning.</li><li>A <a href=https://github.com/>Github</a> account</li></ul><h3 id=install-hugo-create-your-website>Install Hugo, create your website</h3><p>I won&rsquo;t go into much detail about how to install Hugo and create a website. Their <a href=https://gohugo.io/getting-started/quick-start/>Quick Start</a> has pretty much got you covered.</p><h3 id=ready-the-git-repos>Ready the Git repos</h3><p>On Github, create the following:</p><h4 id=website-source-files>Website Source Files</h4><ul><li><p>A private repo <code>my-website</code> for the source files.
You can initialize your existing website folder like this</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cd &lt;website folder&gt;
git init
</code></pre></div><p>Now would be a good idea to add a <code>.gitignore</code> file to avoid uploading unecessary files to Github. See <a href=#some-tips>here</a>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git add .
git commit -m <span style=color:#e6db74>&#39;Initial commit&#39;</span>
git remote add origin &lt;remote repo URL&gt;
git remove -v <span style=color:#75715e>#To verify new remote URL</span>
git push origin master
</code></pre></div></li></ul><h4 id=website-files-to-be-hosted-on-github-pages>Website Files to be hosted on Github Pages</h4><ul><li>A public repo <code>&lt;gh-username>.github.io</code> which will be used to host on Github pages.</li></ul><h4 id=some-tips>Some Tips</h4><ul><li>Use <code>.gitignore</code> to ignore themes and build files/folders. Use <code>.gitkeep</code> to keep required folders that are initially empty when you start. You can have a look at the file I&rsquo;m using <a href=https://gist.github.com/muhannad0/e78f14d7bfa2a1a48320ec7194e5c516>here</a>.</li><li>I&rsquo;d like to mention that there&rsquo;s a couple of changes from the <a href=https://gohugo.io/hosting-and-deployment/hosting-on-github/>official guide</a> that I don&rsquo;t use here:<ul><li>I&rsquo;m not assigning the <code>public</code> folder as a submodule. It&rsquo;s added to <code>.gitignore</code>.</li><li>Instead of the deploy script, I&rsquo;m using Github Actions to deploy to the public repo.</li></ul></li></ul><h3 id=write-a-github-action-to-be-taken-on-commits>Write a Github Action to be taken on commits</h3><p>In order to create an action that would run against your repo, you need to create the action file. When building an action, it&rsquo;s a good idea to map out the steps you want to do before you start writing.</p><p>The steps:</p><ol><li>Run the action upon any push to <code>master</code> branch.</li><li>Checkout the code from <code>my-website</code> repo.</li><li>Install Hugo binary and build the website.</li><li>Push the <code>public</code> folder to <code>&lt;gh-username>.github.io</code> repo.</li></ol><p>Now, I realize that we can write our own action file with run/git commands to achieve this, but I feel that there are dedicated contributers who&rsquo;ve published quality and stable actions that we can start using immediately. A shout out to <a href=https://github.com/peaceiris>Shohei Ueda / peaceiris</a> who&rsquo;s actions I&rsquo;m using for this purpose. There&rsquo;s a really nice collection of actions for you to start with.</p><p>Let&rsquo;s build our file.</p><ul><li>All actions are created in <code>.github/workflows</code> folder. So in you <code>my-website</code> folder:</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>mkdir -p .github/workflows
vim .github/workflows/deploy.yml
</code></pre></div><ul><li>Now for the <code>deploy.yml</code> file.</li></ul><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=color:#66d9ef>name</span>: Deploy Hugo Website

<span style=color:#66d9ef>on</span>:
  <span style=color:#66d9ef>push</span>:
    <span style=color:#66d9ef>branches</span>: [ master ]

<span style=color:#66d9ef>jobs</span>:  
  <span style=color:#66d9ef>deploy</span>:
    <span style=color:#66d9ef>runs-on</span>: ubuntu<span style=color:#ae81ff>-18.04</span>
    <span style=color:#66d9ef>steps</span>:       
    <span style=color:#75715e># Checkout website source</span>
    - <span style=color:#66d9ef>uses</span>: actions/checkout@v2
      <span style=color:#66d9ef>with</span>:
        <span style=color:#66d9ef>submodules</span>: <span style=color:#66d9ef>true</span>
    
    <span style=color:#75715e># Setup Hugo</span>
    - <span style=color:#66d9ef>name</span>: Setup Hugo
      <span style=color:#66d9ef>uses</span>: peaceiris/actions-hugo@v2
      <span style=color:#66d9ef>with</span>:
        <span style=color:#66d9ef>hugo-version</span>: <span style=color:#e6db74>&#39;0.69.0&#39;</span>
        <span style=color:#66d9ef>exetended</span>: <span style=color:#66d9ef>true</span>

    <span style=color:#75715e># Build website</span>
    - <span style=color:#66d9ef>name</span>: Build website
      <span style=color:#66d9ef>run</span>: hugo --minify

    <span style=color:#75715e># Deploy website</span>
    - <span style=color:#66d9ef>name</span>: Deploy website
      <span style=color:#66d9ef>uses</span>: peaceiris/actions-gh-pages@v3
      <span style=color:#66d9ef>with</span>:
        <span style=color:#66d9ef>deploy_key</span>: ${{ secrets.ACTIONS_DEPLOY_KEY }}
        <span style=color:#66d9ef>external_repository</span>: &lt;gh-username&gt;/&lt;gh-username&gt;.github.io
        <span style=color:#66d9ef>publish_branch</span>: master
        <span style=color:#66d9ef>publish_dir</span>: ./public
        <span style=color:#66d9ef>user_name</span>: <span style=color:#e6db74>&#39;github-actions[bot]&#39;</span>
        <span style=color:#66d9ef>user_email</span>: <span style=color:#e6db74>&#39;github-actions[bot]@users.noreply.github.com&#39;</span>
</code></pre></div><p>Let&rsquo;s setup the deploy keys so that our repos are able to access each other during the build process. <a href=https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-create-ssh-deploy-key>Follow this guide here</a>.</p><p>Now make a few changes to your website.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hugo new posts/new-post.md <span style=color:#75715e># Add some content</span>
hugo server <span style=color:#75715e># Run a local server to test</span>
</code></pre></div><p>Commit and push. You can monitor what&rsquo;s going on at the Actions tab on the <code>my-website</code> repo page on Github.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>git add .
git commit -m <span style=color:#e6db74>&#39;new post&#39;</span>
git push
</code></pre></div><h2 id=conclusion>Conclusion</h2><p>With this you can now use Hugo to create a simple static website. You have also setup the necessary git repos to store your source files and deploy the built website to Github Pages.</p><p>We made use of Github Actions to deploy the website automatically on a commit to the source files. Also setup the use of deploy keys to allow access between repositories as the build is processed.</p><p>With this setup, we have a very simple and easy workflow, making changes and pushing it straigh to production, all without leaving your terminal/IDE.</p><h2 id=references>References</h2><p><a href=https://github.com/peaceiris/actions-gh-pages>peaceiris&rsquo; actions-gh-pages</a></p></div><footer></footer></article><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js id=MathJax-script></script><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']}};</script></section></div><footer class=footer><section class=container><p>writing about IT infra, ops, automation, clouds</p>Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main></body></html>