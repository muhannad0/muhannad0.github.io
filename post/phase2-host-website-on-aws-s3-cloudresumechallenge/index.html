<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.69.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=author content="Mohamed Muhannad"><meta name=keywords content="aws,s3,acm,cloudfront,cloudresumechallenge"><meta name=description content="Phase 2 of #CloudResumeChallenge where I work to host a website on AWS."><meta property="og:title" content="Phase 2: Host a website on AWS S3"><meta property="og:description" content="Phase 2 of #CloudResumeChallenge where I work to host a website on AWS."><meta property="og:type" content="article"><meta property="og:url" content="https://muhannad0.github.io/post/phase2-host-website-on-aws-s3-cloudresumechallenge/"><meta property="og:image" content="https://muhannad0.github.io/images/post-images/s3host_cloud_diagram.png"><meta property="article:published_time" content="2020-05-09T01:02:18+05:00"><meta property="article:modified_time" content="2020-05-09T01:02:18+05:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://muhannad0.github.io/images/post-images/s3host_cloud_diagram.png"><meta name=twitter:title content="Phase 2: Host a website on AWS S3"><meta name=twitter:description content="Phase 2 of #CloudResumeChallenge where I work to host a website on AWS."><link rel=icon type=image/png href=/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicon-16x16.png sizes=16x16><link rel=stylesheet type=text/css media=screen href=https://muhannad0.github.io/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://muhannad0.github.io/css/main.css><link rel=stylesheet type=text/css media=screen href=https://muhannad0.github.io/css/all.css><link rel=stylesheet href=https://muhannad0.github.io/css/katex.min.css crossorigin=anonymous><script defer src=https://muhannad0.github.io/js/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://muhannad0.github.io/js/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body);></script><link rel=stylesheet type=text/css media=screen href=https://muhannad0.github.io/css/css/custom.css><title>Phase 2: Host a website on AWS S3 | Muhannad.0</title></head><body><header><div id=avatar><a href=https://muhannad0.github.io/><img src=/images/avatar.jpg alt=Muhannad.0></a></div><div id=titletext><h2 id=title><a href=https://muhannad0.github.io/>Muhannad.0</a></h2></div><div id=title-description><p id=subtitle>mostly about cloud, automation, IT infra, ops. but wait, there&rsquo;s more&mldr;</p><div id=social><nav><ul><li><a href=https://github.com/muhannad0/><i title=Github class="icons fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/muhannad0/><i title=LinkedIn class="icons fab fa-linkedin"></i></a></li><li><a href=https://twitter.com/monde_><i title=Twitter class="icons fab fa-twitter"></i></a></li></ul></nav></div></div><div id=mainmenu><nav><ul><li><a href=/>Home</a></li><li><a href=/post>All Posts</a></li><li><a href=/about>About</a></li><li><a href=/tags>Tags</a></li><li><a href=/categories>Categories</a></li></ul></nav></div></header><main><div class=post><div class=author></div><div class=post-header><div class=meta><div class=date><span class=day>09</span>
<span class=rest>May 2020</span></div></div><div class=matter><h1 class=title>Phase 2: Host a website on AWS S3</h1></div></div><div class=markdown><p>Time for Phase 2 of the #CloudResumeChallenge, hosting the resume website on AWS.</p><h1 id=what-do-i-need-for-this>What do I need for this?</h1><ul><li><a href=https://aws.amazon.com/>An AWS account</a>.</li><li>A domain name.</li><li>S3 buckets.</li><li>SSL Certificate from Amazon Certificate Manager (ACM).</li><li>Amazon Cloudfront</li></ul><h1 id=why-do-i-need-those>Why do I need those?</h1><h2 id=an-aws-account>An AWS Account</h2><p>An account is needed because we&rsquo;re trying to learn how to use the Amaz-ing Web Services platform, obviously.</p><h2 id=a-domain-name>A Domain Name</h2><p>It&rsquo;s best to use an easy to remember address when giving out your website details to people. No one can remember some address like <code>websites-s3s-regions.aws.coms</code>.</p><p>If you&rsquo;d like to stick with full AWS services, Route53 is the way to go. You can also use another DNS provider like <a href=https://www.namecheap.com/>Namecheap</a>, where I got mine.</p><h2 id=s3-buckets>S3 Buckets</h2><p>We&rsquo;ll need somewhere to store our website files. S3 is the tool for this job. It also allows you to allow public access so that you could technically host a basic website straight from the bucket (static-site hosting, as it is called).</p><p>‚ùó Be very aware when doing this (for other buckets), since it&rsquo;s never a good idea to have your data accessible to the world. ‚ùó</p><h2 id=ssl-certificate-from-acm>SSL Certificate from ACM</h2><p>Since ACM enables you to create free SSL certificates for use with other AWS resources, we&rsquo;ll be using this to secure access to our website. After all, everyone would like to see the üîí icon on the browser when visiting your website these days.</p><h2 id=amazon-cloudfront>Amazon Cloudfront</h2><p>Cloudfront offers a global content delivery network (CDN) for your website with integration to ACM so that you can secure your website with SSL.</p><p>This is the main reason for use of Cloudfront (to enable HTTPS for security) for this project. But having a fast website (witht eh help of CDN) is a huge bonus as well.</p><h1 id=lets-get-to-work>Let&rsquo;s Get to Work</h1><p>Now that we got the items we need all set, I&rsquo;ll forward you to the official guide from AWS explaining step by step how to get your buckets ready, domain name pointed to the right resources, enabling Cloudfront.</p><p><a href=https://docs.aws.amazon.com/AmazonS3/latest/dev/hosting-websites-on-s3-examples.html>Hosting Websites on S3: Example Walkthrough</a></p><p>Below is a diagram to help visualizing how the parts work together.</p><p><img src=/images/post-images/s3host_cloud_diagram.png alt="Cloud Digram"></p><p>Now, here I&rsquo;d like to mention that there are couple of things you have to keep in mind when following their guide.</p><h2 id=comments-on-configuration>Comments on configuration</h2><h3 id=s3-buckets-1>S3 Buckets</h3><p>I used 2 buckets, one main and one for <code>www</code> subdomain (which just redirects requests to main). Public access is enabled on the main bucket only.</p><p><img src=/images/post-images/s3host_buckets_list.png alt="S3 Buckets"></p><p><em>SIDE NOTE: I skipped creating a <code>logs</code> bucket for now. Maybe I&rsquo;ll get to enabling logging later on.</em></p><h3 id=domain-configuration>Domain Configuration</h3><p>Since I&rsquo;m using another provider, I used <code>CNAME</code> records to point my domain to the correct endpoints.</p><p>Example:</p><ul><li><code>example.com.</code> or <code>@</code> &ndash;> <code>CNAME</code> record pointing to S3/Cloudfront endpoint.</li><li><code>www.example.com.</code> or <code>www</code> &ndash;> <code>CNAME</code> record pointing to S3/Cloudfront endpoint.</li></ul><h3 id=cloudfront-with-ssl-configuration>Cloudfront with SSL Configuration</h3><p>This is where I started tripping up. I started getting <code>403</code> errors and strange redirects when accessing the generated Cloudfront URL.</p><p>Couple of hours went by Googling for fixes and turns out I mostly I missed reading the help texts when filling out the fields. üòì</p><p>So I&rsquo;d like to highlight couple of things to note before and while you&rsquo;re working to enable Cloudfront.</p><h4 id=get-your-ssl-certificates-ready-first><em><strong>Get your SSL certificates ready first</strong></em></h4><p>Head over to ACM and follow the instructions to get a SSL certificate for your domain.</p><p><em>SIDE NOTE: When using DNS validation, make sure to remove the domain name from the generated name when creating <code>CNAME</code> records on your DNS provider. For example in <code>_randomvalue.example.com.</code> remove the <code>.example.com.</code> and just use the <code>_randomvalue</code>.</em></p><p><img src=/images/post-images/s3host_acm_certs.png alt="ACM Certificates"></p><p>Once those are set, you can begin configuring Cloudfront. But here&rsquo;s a couple of notes on doing that. I found some points that were not so clear in the official documentation.</p><h4 id=origin-settings><em><strong>Origin Settings</strong></em></h4><p>Origin domain name should be in the format <code>&lt;bucket-name>.s3.&lt;aws-region>.amazonaws.com.</code>. If it&rsquo;s not provided in this format, you would find that accessing the Cloudfront generated endpoint from a browser does a redirect to the S3 bucket endpoint.</p><p><img src=/images/post-images/s3host_cloudfront_origin_settings.png alt="Cloudfront Origin Settings"></p><h4 id=redirect-http-to-https><em><strong>Redirect HTTP to HTTPS</strong></em></h4><p>Since we want to secure our website, select this option.</p><p><img src=/images/post-images/s3host_cloudfront_redirect_https.png alt="Cloudfront HTTPS Redirect"></p><h4 id=enabling-https-with-custom-domain><em><strong>Enabling HTTPS with Custom Domain</strong></em></h4><p>To enable secure access with out custom domain, you need to provide <code>Alternate Domain Names (CNAME)</code> and select the <code>Custom SSL Certificate</code> option with the certificate created earlier in ACM.</p><p><img src=/images/post-images/s3host_cloudfront_custom_domain_ssl_settings.png alt="Cloudfront Custom SSL"></p><h4 id=waiting-for-cloudfront-to-finish><em><strong>Waiting for Cloudfront to finish</strong></em></h4><p>Once the settings are saved, Cloudfront starts configuring the CDN for your websites and provides an endpoint. You can first test whether everything works using the provided endpoint to access the website, before updating the DNS records.</p><h4 id=update-dns-to-cloudfront><em><strong>Update DNS to Cloudfront</strong></em></h4><p>Finally, once everything is working fine update the DNS records for the domain to point to the Cloudfront endpoint provided.</p><h2 id=success>Success!</h2><p>If all went well, the webpage should now be accessible using your custom domain name.</p><p>Have a look at mine at <a href=https://muhannad.io/>muhannad.io</a> üòÑ</p><p>Next phase should be interesting. It&rsquo;s a development project again. But this time with a language and database I&rsquo;ve never used. üòÅ</p></div><div class=tags><div class=taxosfloating_left><p>Categories</p></div><div class=termsfloating_right><p><a href=/categories/blog/>blog</a>
<a href=/categories/guide/>guide</a></div><div class=clearit></div><div class=taxosfloating_left><p>Tags</p></div><div class=termsfloating_right><p><a href=/tags/acm/>acm</a>
<a href=/tags/aws/>aws</a>
<a href=/tags/cloudfront/>cloudfront</a>
<a href=/tags/cloudresumechallenge/>cloudresumechallenge</a>
<a href=/tags/s3/>s3</a></div><div class=clearit></div></div></div></main><footer><a href=https://github.com/dataCobra/hugo-vitae>Vitae</a> theme for <a href=https://gohugo.io>Hugo</a>
<script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-166606040-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></footer></body></html>